<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Calebs Site</title>
    <link>http://localhost:1313/</link>
    <description>Calebs Site</description>
    <generator>Hugo 0.147.5 &amp; FixIt v0.3.21-a85a6655</generator>
    <language>en</language>
    <lastBuildDate>Sat, 25 May 2024 10:00:00 +0800</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Setting up Monit</title>
      <link>http://localhost:1313/posts/welcome/</link>
      <pubDate>Sat, 25 May 2024 10:00:00 +0800</pubDate>
      <guid>http://localhost:1313/posts/welcome/</guid>
      <category domain="http://localhost:1313/categories/general/">General</category>
      <description>&lt;p&gt;&lt;a href=&#34;https://mmonit.com/monit/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Monit&lt;/a&gt; is an open source tool for monitoring and managing processes, programs, files, directories and filesystems. You can program Monit to execute actions for events such as the status of a running process or if your machine&amp;rsquo;s CPU consumption reaches a certain threshold. &lt;a href=&#34;https://mmonit.com/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;M/Monit&lt;/a&gt; is usually installed alongside Monit as it (according to the definition on mmonit.com) &lt;em&gt;&amp;ldquo;builds on Monit&amp;rsquo;s capabilities and provides monitoring and management of all your Monit enabled hosts via a modern, clean and well designed user interface which also works on mobile devices.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;installing-monit&#34;&gt;&lt;span&gt;&lt;strong&gt;Installing Monit:&lt;/strong&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#installing-monit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;step-1-update-your-system&#34;&gt;&lt;span&gt;Step 1: Update Your System&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1-update-your-system&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Centos 7:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo yum install epel-release&#xA;sudo yum update&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ubuntu:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo apt update&#xA;sudo apt upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;step-2-install-monit-package&#34;&gt;&lt;span&gt;Step 2: Install Monit Package&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2-install-monit-package&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Centos 7:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo yum install monit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ubuntu:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo apt install monit&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;step-3-configure-monit&#34;&gt;&lt;span&gt;Step 3: Configure Monit&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-3-configure-monit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To configure Monit we need to open the main configuration file. This can typically be found at &lt;code&gt;/etc/monitrc&lt;/code&gt; or &lt;code&gt;/etc/monit/monitrc&lt;/code&gt;. In my example I have commented out the default values and set all values at the end of the file as it is easier to read, however you can replace the default values if you wish.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-31-basic-settings&#34;&gt;&lt;span&gt;&lt;strong&gt;Step 3.1 Basic Settings&lt;/strong&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-31-basic-settings&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;We can set the cycle (frequency) at which monit makes it&amp;rsquo;s checks (default is 30 seconds) and optionally set a delay after system boot or Monit start:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set daemon 30&#xA;&#x9;with start delay 240&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logging can be set as the default:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set log syslog&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;or the location can be set to a standalone file:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set log /var/log/monit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To enable the web interface we need to set the following values which allows the admin to access the web interface from any network:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set httpd port 2812 and&#xA;    use address 0.0.0.0&#xA;    allow 0.0.0.0/0&#xA;    allow admin:monit      # change this value from the default&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-32-set-up-azure-mail-server-optional&#34;&gt;&lt;span&gt;&lt;strong&gt;Step 3.2 Set Up Azure Mail Server (Optional)&lt;/strong&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-32-set-up-azure-mail-server-optional&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;For Monit to send emails for alerts we need to set the mail server configuration in the &lt;code&gt;monitrc&lt;/code&gt; config file.&lt;/p&gt;&#xA;&lt;p&gt;Set the email address that alerts will be sent to:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set alert example@email.com&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can change the email format using the default template:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;## set mail-format {&#xA;##   from:    Monit &amp;lt;monit@$HOST&amp;gt;&#xA;##   subject: monit alert --  $EVENT $SERVICE&#xA;##   message: $EVENT Service $SERVICE&#xA;##                 Date:        $DATE&#xA;##                 Action:      $ACTION&#xA;##                 Host:        $HOST&#xA;##                 Description: $DESCRIPTION&#xA;##&#xA;##            Your faithful employee,&#xA;##            Monit&#xA;## }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You might want to change the &lt;code&gt;from&lt;/code&gt; to whichever email will be used by your mail server:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set mail-format { from: example@company.com }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you already have a mail server set up you can replace the following values with your own:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set mailserver {host} port 587&#xA;    username &amp;#34;{username}&amp;#34; password &amp;#34;{password}&amp;#34;&#xA;    using tlsv12&#xA;    with timeout 30 seconds&#xA;SET TLS options{VERSION: AUTO}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you would like to set this up with azure you can follow these steps:&lt;/p&gt;&#xA;&lt;p&gt;Open this link: &lt;a href=&#34;https://admin.microsoft.com/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://admin.microsoft.com/&lt;/a&gt;&lt;br&gt;&#xA;Go to Users &amp;gt; Active Users :&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/images/azure-screenshot1.png&#39; alt=&#34;Alt text&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Either create a new user or select an existing user to use as the mailbox. Note that they must have Exchange Online access (typically included with a Microsoft 365 licence).&lt;/p&gt;&#xA;&lt;p&gt;Select the User then select Mail &amp;gt; Manage email apps &amp;gt; Enable Authenticated SMTP&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/images/azure-screenshot2.png&#39; alt=&#34;Alt text&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Now in our mailserver configuration for monit we can set the following values:&#xA;host = smtp.office365.com&#xA;username = azure email address e.g. &lt;a href=&#34;mailto:no-reply@company.com&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;no-reply@company.com&lt;/a&gt;&#xA;password = azure user password&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;step-4-enable-and-start-monit&#34;&gt;&lt;span&gt;Step 4: Enable and Start Monit&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-4-enable-and-start-monit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Enable Monit to start automatically during system boot and start it:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo systemctl enable monit&#xA;sudo systemctl start monit&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
  </channel>
</rss>
